<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>ReadIt Comentarios</title>
    <link rel="icon" href="images/logo.png">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet"/>
    <link href="styles.css" rel="stylesheet"> <!-- Archivo CSS externo -->
    <!-- Visualizar archivos --> <!-- PDF.js viewer embebido -->
    <script src="https://mozilla.github.io/pdf.js/build/pdf.js"></script>

    <script>
        function showSection(sectionId, tabId) {
            document.getElementById('informacion').style.display = 'none';
            document.getElementById('lecturas').style.display = 'none';
            document.getElementById('eventos').style.display = 'none';
            document.getElementById(sectionId).style.display = 'block';

            document.getElementById('tab-informacion').classList.remove('active-tab');
            document.getElementById('tab-lecturas').classList.remove('active-tab');
            document.getElementById('tab-eventos').classList.remove('active-tab');
            document.getElementById(tabId).classList.add('active-tab');
        }

        function showSection2(sectionId, tabId) {
            document.getElementById('libro-curso').style.display = 'none';
            document.getElementById('proxima-lectura').style.display = 'none';
            document.getElementById(sectionId).style.display = 'block';

            document.getElementById('tab-libro-curso').classList.remove('active-tab');
            document.getElementById('tab-proxima-lectura').classList.remove('active-tab');
            document.getElementById(tabId).classList.add('active-tab');
        }

        function toggleEvento() {
            let tipoEvento = document.getElementById("tipoEvento").value;
            let campoVirtual = document.getElementById("campoVirtual");
            let campoPresencial = document.getElementById("campoPresencial");

            if (tipoEvento === "virtual") {
                campoVirtual.classList.remove("d-none");
                campoPresencial.classList.add("d-none");
            } else {
                campoVirtual.classList.add("d-none");
                campoPresencial.classList.remove("d-none");
            }
        }

        function toggleProfileMenu() {
            let menu = document.getElementById('profile-menu');
            menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
        }

        function toggleNotificationMenu() {
            let menu = document.getElementById('notification-menu');
            menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
        }

        function toggleFavorite(icon) {
            icon.classList.toggle('fas');
            icon.classList.toggle('far');
        }

        function toggleOptionsMenu(menuId) {
            const menu = document.getElementById(menuId);
            menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
        }

        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function hideModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function goToClubPage() {
            window.location.href = 'club.html';
        }
    </script>
</head>
<body class="bg-light">
<header class="bg-warning p-4 d-flex justify-content-between align-items-center">
    <div class="d-flex align-items-center">
        <img alt="Logo" class="rounded-circle" height="60" src="images/logo.png" width="60"/>
        <h1 class="text-dark font-weight-bold ml-2">Read-It</h1>
    </div>
    <div class="d-flex align-items-center">
        <input class="form-control rounded-left" placeholder="Buscar" type="text"/>
        <button class="btn btn-dark rounded-right" >
            <i class="fas fa-search"></i>
        </button>
    </div>

    <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="notification-container d-flex align-items-center position-relative" onclick="toggleNotificationMenu()">
            <i class="fas fa-bell text-dark mr-3 position-relative" style="font-size: 1.5rem;">
                <span id="notification-badge" class="badge badge-danger position-absolute" style="top: -15px; right: -15px; display: none;">3</span>
            </i>
            <div id="notification-menu" class="notification-menu">
                <a href="#" class="notification-item unread" onclick="markAsRead(event, this)">Notificación 1</a>
                <a href="#" class="notification-item unread" onclick="markAsRead(event, this)">Notificación 2</a>
                <a href="#" class="notification-item unread" onclick="markAsRead(event, this)">Notificación 3</a>
            </div>
        </div> 
    
        <div class="profile-container d-flex align-items-center" onclick="toggleProfileMenu()">
            <i class="fas fa-user-circle text-dark" style="font-size: 2rem;"></i>
            <i id="profile-arrow" class="fas fa-chevron-down text-dark ml-2 "></i>
            <div id="profile-menu" class="profile-menu">
                <a href="myprofile.html">Mi perfil</a>
                <a href="#">Configuración</a>
                <a href="#">Cerrar sesión</a>
            </div>
        </div>
    </div>
</header>

<div class="d-flex align-items-center bg-primary" style="height: 5px;"></div>
<img alt="Club Romántica" class="card-img-top club-banner" src="https://storage.googleapis.com/a1aa/image/zrtnSTdJfTjgSJ6YfnlvKs-GNyU8JoToDo1kETZvyK4.jpg"/>
<div class="d-flex align-items-center bg-primary" style="height: 50px;">
  <h1 class="text-dark font-weight-bold ml-2" id="NombreClub"></h1>
</div>

<div class="container-fluid px-4">
    <div class="row min-vh-100">
      
      <!-- Sección Izquierda -->
    <div class="col-md-6 d-flex flex-column bg-light overflow-auto">
        <h2 class="text-center mt-4">Nombre del libro PDF</h2>
        <div class="p-3">
        <div style="height: 80vh; overflow: hidden;">
            <iframe
            src="DOCUMENTOS/Alcance del Software - ReadIt.pdf"
            width="100%"
            height="100%"
            style="border: none;"
            allowfullscreen
            ></iframe>
        </div>
        </div>
    </div>
<!-- Sección Derecha -->
<div class="col-md-6 d-flex flex-column bg-warning overflow-auto">
    <h2 class="text-center mt-4">Comentarios</h2>
    <div class="p-3">
      <!-- Área para agregar nuevo comentario -->
      <div class="mb-3">
        <input type="text" id="newComment" class="form-control" placeholder="Escribe un comentario..." />
        <button onclick="addComment()" class="btn btn-dark mt-2">Publicar</button>
      </div>
  
      <!-- Lista de comentarios -->
      <div id="commentSection">
        <!-- Comentarios aparecerán aquí -->
      </div>
    </div>
  </div>
  
  <script>
    // Almacenar los usuarios que han dado "Me gusta" a cada comentario
    const likedUsers = new Map();
  
    function addComment() {
      const commentText = document.getElementById("newComment").value.trim();
      if (commentText === "") return;
  
      const commentSection = document.getElementById("commentSection");
  
      const commentDiv = document.createElement("div");
      commentDiv.classList.add("d-flex", "mb-3");
  
      // Nombre de usuario fijo por ahora (puedes hacerlo dinámico)
      const userName = "Usuario";
  
      // Avatar de usuario simulado
      const avatarHTML = `
        <img src="https://i.pravatar.cc/40?img=${Math.floor(Math.random() * 70) + 1}"
             class="rounded-circle me-2 mt-1" style="width: 40px; height: 40px;" alt="avatar">
      `;
  
      const contentHTML = `
        <div class="flex-grow-1">
          <div class="bg-light px-3 py-2 rounded-3">
            <p class="mb-1 fw-bold text-primary comment-author">${userName}</p>
            <p class="mb-1">${commentText}</p>
          </div>
          <div class="text-muted small mt-1 ms-1">
            <span class="me-3" onclick="toggleLike(this)">Me gusta <span class="like-count">0</span></span>
            <span class="me-3" onclick="toggleReplyInput(this)" class="responder">Responder</span>
            <span>1 min</span>
          </div>
          <!-- Input de respuesta inicialmente oculto -->
          <input type="text" class="form-control form-control-sm mt-2 mb-1 reply-input" placeholder="Responder..." style="display: none;" />
          <button class="btn btn-sm btn-outline-secondary" onclick="replyToComment(this)" style="display: none;">Responder</button>
          <div class="replies mt-2 ps-3 border-start"></div>
        </div>
      `;
  
      commentDiv.innerHTML = avatarHTML + contentHTML;
      commentSection.appendChild(commentDiv);
      document.getElementById("newComment").value = "";
    }
  
    // Función para activar o desactivar el "Me gusta"
    function toggleLike(span) {
      const likeCount = span.querySelector(".like-count");
      const userName = "Usuario";  // Aquí podrías capturar el usuario real
  
      // Verificar si el usuario ya ha dado "Me gusta"
      if (likedUsers.has(userName)) {
        // El usuario ya ha dado "Me gusta", lo quitamos
        likedUsers.delete(userName);
        likeCount.textContent = parseInt(likeCount.textContent) - 1;
      } else {
        // El usuario no ha dado "Me gusta", lo añadimos
        likedUsers.set(userName, true);
        likeCount.textContent = parseInt(likeCount.textContent) + 1;
      }
    }
  
    function toggleReplyInput(span) {
      const replyInput = span.closest(".flex-grow-1").querySelector(".reply-input");
      const replyButton = span.closest(".flex-grow-1").querySelector("button");
      
      // Alternar la visibilidad del input y el botón
      const isHidden = replyInput.style.display === "none";
      replyInput.style.display = isHidden ? "block" : "none";
      replyButton.style.display = isHidden ? "block" : "none";
    }
  
    function replyToComment(button) {
      const input = button.previousElementSibling;
      const replyText = input.value.trim();
      if (replyText === "") return;
  
      // Obtener el nombre del autor del comentario original
      const commentContainer = button.closest(".flex-grow-1");
      const authorName = commentContainer.querySelector(".comment-author").textContent;
  
      // Avatar de usuario para la respuesta
      const replyAvatarHTML = `
        <img src="https://i.pravatar.cc/40?img=${Math.floor(Math.random() * 70) + 1}"
             class="rounded-circle me-2 mt-1" style="width: 30px; height: 30px;" alt="avatar">
      `;
  
      const replyDiv = document.createElement("div");
      replyDiv.classList.add("bg-body-secondary", "p-2", "rounded", "mb-2", "d-flex");
  
      replyDiv.innerHTML = `
        ${replyAvatarHTML}
        <div>
          <p class="mb-0"><strong>${authorName}:</strong> ${replyText}</p>
        </div>
      `;
  
      const repliesContainer = button.nextElementSibling;
      repliesContainer.appendChild(replyDiv);
      input.value = "";
    }
  </script>

</body>
</html>